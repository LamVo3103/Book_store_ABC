<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T√†i Kho·∫£n - Nh√† S√°ch ABC</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .account-container {
        max-width: 1200px;
        margin: 30px auto;
        padding: 20px;
        display: flex;
        gap: 30px;
      }

      .account-sidebar {
        width: 250px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        padding: 20px;
      }

      .account-content {
        flex: 1;
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        padding: 30px;
      }

      .account-menu h3 {
        color: #1976d2;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .account-menu ul {
        list-style: none;
      }

      .account-menu li {
        margin-bottom: 10px;
      }

      .account-menu a {
        display: block;
        padding: 10px;
        color: #333;
        text-decoration: none;
        border-radius: 5px;
        transition: all 0.3s;
      }

      .account-menu a:hover,
      .account-menu a.active {
        background-color: #e3f2fd;
        color: #0d47a1;
      }

      .account-menu a i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
      }

      .orders-title {
        color: #1976d2;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #e3f2fd;
      }

      .order-card {
        border: 1px solid #ddd;
        border-radius: 10px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .order-header {
        background-color: #f5f5f5;
        padding: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ddd;
      }

      .order-id {
        font-weight: bold;
        color: #1976d2;
      }

      .order-date {
        color: #666;
      }

      .order-status {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: bold;
      }

      .status-pending {
        background-color: #fff3cd;
        color: #856404;
      }

      .status-completed {
        background-color: #d4edda;
        color: #155724;
      }

      .status-cancelled {
        background-color: #f8d7da;
        color: #721c24;
      }

      .order-body {
        padding: 15px;
      }

      .order-item {
        display: flex;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 1px dashed #eee;
      }

      .order-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }

      .order-item-img {
        width: 80px;
        height: 100px;
        object-fit: cover;
        border-radius: 5px;
        margin-right: 15px;
      }

      .order-item-info {
        flex: 1;
      }

      .order-item-name {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }

      .order-item-price {
        color: #1976d2;
        font-weight: bold;
      }

      .order-item-quantity {
        color: #666;
      }

      .order-summary {
        margin-top: 20px;
        padding-top: 15px;
        border-top: 2px solid #eee;
      }

      .summary-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .summary-total {
        font-weight: bold;
        font-size: 18px;
        color: #0d47a1;
      }

      .order-actions {
        margin-top: 15px;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .order-btn {
        padding: 8px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
      }

      .cancel-btn {
        background-color: #dc3545;
        color: white;
      }

      .cancel-btn:hover {
        background-color: #c82333;
      }

      .view-btn {
        background-color: #6c757d;
        color: white;
      }

      .view-btn:hover {
        background-color: #5a6268;
      }

      .empty-orders {
        text-align: center;
        padding: 50px;
        color: #666;
      }

      .empty-orders i {
        font-size: 50px;
        color: #90caf9;
        margin-bottom: 20px;
      }

      .empty-orders p {
        margin-bottom: 20px;
        font-size: 18px;
      }

      .shop-btn {
        display: inline-block;
        padding: 10px 20px;
        background-color: #1976d2;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        font-weight: bold;
        transition: background-color 0.3s;
      }

      .shop-btn:hover {
        background-color: #0d47a1;
      }

      @media (max-width: 768px) {
        .account-container {
          flex-direction: column;
        }

        .account-sidebar {
          width: 100%;
          margin-bottom: 20px;
        }

        .order-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }

        .order-actions {
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <!-- HEADER (Gi·ªëng c√°c trang kh√°c) -->
    <header>
      <a href="index.html">
        <div class="logo">
          <h1>Nh√† S√°ch ABC</h1>
        </div>
      </a>

      <nav class="nav-menu">
        <ul>
          <li><a href="index.html" style="color: #fbbf24">Trang Ch·ªß</a></li>
          <li><a href="tatcasanpham.html">S·∫£n Ph·∫©m</a></li>
          <li><a href="#footer">Li√™n H·ªá</a></li>
          <li>
            <a href="cacdonhang.html"> ƒê∆°n h√†ng</a>
          </li>
          <li><a href="theodoidonhang.html">Theo d√µi ƒë∆°n h√†ng</a></li>
        </ul>
      </nav>

      <!-- B·ªè search-cart v√† user-actions v√†o 1 container chung -->
      <div class="header-right">
        <div class="search-cart">
          <input type="text" placeholder="T√¨m ki·∫øm s√°ch..." />
          <button>T√¨m</button>
          <a href="#" class="cart">üõí</a>
        </div>

        <div class="user-actions">
          <div class="auth-dropdown">
            <button class="auth-btn" id="userMenuBtn">
              <i class="fas fa-user"></i> T√†i kho·∫£n
            </button>
            <div class="auth-dropdown-content">
              <a href="account.html"><i class="fas fa-user"></i> T√†i kho·∫£n</a>
              <a href="giohang.html"
                ><i class="fas fa-shopping-cart"></i> Gi·ªè h√†ng</a
              >
              <a href="#" id="logoutLink"
                ><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</a
              >
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- N·ªôi dung t√†i kho·∫£n -->
    <div class="account-container">
      <div class="account-sidebar">
        <div class="account-menu">
          <h3>T√†i kho·∫£n c·ªßa t√¥i</h3>
          <ul>
            <li>
              <a href="" class="active"
                ><i class="fas fa-user"></i> Th√¥ng tin ƒë∆°n h√†ng</a
              >
            </li>
            <li>
              <a href="account.html">
                <i class="fas fa-clipboard-list"></i> Th√¥ng tin c√° nh√¢n</a
              >
            </li>
          </ul>
        </div>
      </div>

      <div class="account-content">
        <h2 class="orders-title">
          <i class="fas fa-clipboard-list"></i> ƒê∆°n h√†ng c·ªßa t√¥i
        </h2>

        <div id="orders-list">
          <div class="empty-orders">
            <i class="fas fa-shopping-bag"></i>
            <p>B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>
            <a href="index.html" class="shop-btn">Mua s·∫Øm ngay</a>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer" id="footer">
      <div class="footer-container">
        <div class="footer-column-left">
          <h1>Nh√† S√°ch ABC</h1>
          <p>189 Cao L·ªó Ph∆∞·ªùng 4 Qu·∫≠n 8 TP HCM</p>
          <p>
            Fahasa.com nh·∫≠n ƒë·∫∑t h√†ng tr·ª±c tuy·∫øn v√† giao h√†ng t·∫≠n n∆°i. KH√îNG h·ªó
            tr·ª£ ƒë·∫∑t mua v√† nh·∫≠n h√†ng tr·ª±c ti·∫øp t·∫°i vƒÉn ph√≤ng c≈©ng nh∆∞ t·∫•t c·∫£ H·ªá
            Th·ªëng Fahasa tr√™n to√†n qu·ªëc.
          </p>
          <div class="social-logo">
            <img
              src="https://cdn0.fahasa.com/skin/frontend/ma_vanese/fahasa/images/footer/Facebook-on.png"
            />
            <img
              src="https://cdn0.fahasa.com/skin/frontend/ma_vanese/fahasa/images//footer/Youtube-on.png"
            />
          </div>
        </div>
        <!-- D·ªãch v·ª• -->
        <div class="footer-column-right mobile-collapsible">
          <h3 onclick="location.href='dichvu.html'">D·ªäCH V·ª§</h3>
          <div class="mobile-hide">
            <p>ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</p>
            <p>Ch√≠nh s√°ch b·∫£o m·∫≠t th√¥ng tin c√° nh√¢n</p>
            <p>Ch√≠nh s√°ch b·∫£o m·∫≠t thanh to√°n</p>
            <p>Gi·ªõi thi·ªáu</p>
            <p>H·ªá th·ªëng trung t√¢m - nh√† s√°ch</p>
          </div>
        </div>

        <!-- Ch√≠nh s√°ch -->
        <div class="footer-column-right mobile-collapsible">
          <h3 onclick="location.href='chinhsach.html'">H·ªñ TR·ª¢</h3>
          <div class="mobile-hide">
            <p>Ch√≠nh s√°ch ƒë·ªïi - tr·∫£ - ho√†n ti·ªÅn</p>
            <p>Ch√≠nh s√°ch b·∫£o h√†nh - b·ªìi ho√†n</p>
            <p>Ch√≠nh s√°ch v·∫≠n chuy·ªÉn</p>
            <p>Ch√≠nh s√°ch kh√°ch s·ªâ</p>
          </div>
        </div>

        <!-- T√†i kho·∫£n -->
        <div class="footer-column-right mobile-collapsible">
          <h3 onclick="location.href='login.html'">T√ÄI KHO·∫¢N C·ª¶A T√îI</h3>
          <div class="mobile-hide">
            <p>ƒêƒÉng nh·∫≠p / T·∫°o m·ªõi t√†i kho·∫£n</p>
            <p>Thay ƒë·ªïi ƒë·ªãa ch·ªâ kh√°ch h√†ng</p>
            <p>Chi ti·∫øt t√†i kho·∫£n</p>
            <p>Gi·ªè h√†ng</p>
          </div>
        </div>

        <div class="footer-column-right">
          <h3>LI√äN H·ªÜ</h3>
          <i class="fas fa-map-marker-alt fa-lg"></i>
          <span>189 Cao L·ªó P4, Q8, TP HCM</span>
        </div>
        <div class="footer-column-right">
          <h4>&nbsp;</h4>
          <i class="fas fa-envelope fa-lg"></i>
          <span>cskh@abc.com.vn</span>
        </div>
        <div class="footer-column-right">
          <h4>&nbsp;</h4>
          <i class="fas fa-phone fa-lg"></i>
          <span>0987654321</span>
        </div>
        <div class="logo">
          <img
            src="https://cdn0.fahasa.com/media/wysiwyg/Logo-NCC/Logo_ninjavan.png"
            width="150px"
          />
        </div>
        <div class="logo">
          <img
            src="https://cdn1.fahasa.com/media//wysiwyg/Logo-NCC/momopay.png"
            height="50px"
          />
        </div>
        <div class="logo">
          <img
            src="https://cdn1.fahasa.com/media//wysiwyg/Logo-NCC/logo_zalopay_2.png"
            height="40px"
          />
        </div>

        <div class="credits">
          <p>&copy; Nh√† s√°ch ABC</p>
        </div>
      </div>
    </footer>

    <script>
      // L·∫•y ƒë∆°n h√†ng t·ª´ localStorage
      function loadOrders() {
        const orders = JSON.parse(localStorage.getItem("orders")) || [];
        const ordersList = document.getElementById("orders-list");

        if (orders.length === 0) {
          ordersList.innerHTML = `
                    <div class="empty-orders">
                        <i class="fas fa-shopping-bag"></i>
                        <p>B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>
                        <a href="index.html" class="shop-btn">Mua s·∫Øm ngay</a>
                    </div>
                `;
          return;
        }

        ordersList.innerHTML = "";

        // Hi·ªÉn th·ªã c√°c ƒë∆°n h√†ng theo th·ª© t·ª± m·ªõi nh·∫•t l√™n ƒë·∫ßu
        orders.reverse().forEach((order, index) => {
          const orderId = `ABC-${new Date(order.date)
            .getTime()
            .toString()
            .slice(-6)}`;
          const orderDate = new Date(order.date).toLocaleString("vi-VN");
          let statusClass = "status-pending";
          let statusText = "ƒêang x·ª≠ l√Ω";

          if (order.status === "completed") {
            statusClass = "status-completed";
            statusText = "ƒê√£ ho√†n th√†nh";
          } else if (order.status === "cancelled") {
            statusClass = "status-cancelled";
            statusText = "ƒê√£ h·ªßy";
          }

          let orderHTML = `
                    <div class="order-card" data-order-id="${orderId}">
                        <div class="order-header">
                            <div>
                                <span class="order-id">M√£ ƒë∆°n h√†ng: ${orderId}</span>
                                <span class="order-date"> - ${orderDate}</span>
                            </div>
                            <span class="order-status ${statusClass}">${statusText}</span>
                        </div>
                        <div class="order-body">
                `;

          let subtotal = 0;
          order.items.forEach((item) => {
            const itemTotal = item.price * item.quantity;
            subtotal += itemTotal;

            orderHTML += `
                        <div class="order-item">
                            <img src="${item.image}" alt="${
              item.name
            }" class="order-item-img">
                            <div class="order-item-info">
                                <div class="order-item-name">${item.name}</div>
                                <div class="order-item-price">${item.price.toLocaleString(
                                  "vi-VN"
                                )}‚Ç´</div>
                                <div class="order-item-quantity">S·ªë l∆∞·ª£ng: ${
                                  item.quantity
                                }</div>
                            </div>
                        </div>
                    `;
          });

          const shippingFee = 20000;
          const total = subtotal + shippingFee;

          orderHTML += `
                            <div class="order-summary">
                                <div class="summary-row">
                                    <span>T·∫°m t√≠nh:</span>
                                    <span>${subtotal.toLocaleString(
                                      "vi-VN"
                                    )}‚Ç´</span>
                                </div>
                                <div class="summary-row">
                                    <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                                    <span>${shippingFee.toLocaleString(
                                      "vi-VN"
                                    )}‚Ç´</span>
                                </div>
                                <div class="summary-row summary-total">
                                    <span>T·ªïng c·ªông:</span>
                                    <span>${total.toLocaleString(
                                      "vi-VN"
                                    )}‚Ç´</span>
                                </div>
                            </div>
                `;

          // Ch·ªâ hi·ªÉn th·ªã n√∫t h·ªßy n·∫øu ƒë∆°n h√†ng ch∆∞a ho√†n th√†nh ho·∫∑c h·ªßy
          if (!order.status || order.status === "pending") {
            orderHTML += `
                            <div class="order-actions">
                                <button class="order-btn view-btn">Xem chi ti·∫øt</button>
                                <button class="order-btn cancel-btn" onclick="cancelOrder('${orderId}')">H·ªßy ƒë∆°n h√†ng</button>
                            </div>
                    `;
          } else {
            orderHTML += `
                            <div class="order-actions">
                                <button class="order-btn view-btn">Xem chi ti·∫øt</button>
                            </div>
                    `;
          }

          orderHTML += `
                        </div>
                    </div>
                `;

          ordersList.innerHTML += orderHTML;
        });
      }

      // H√†m h·ªßy ƒë∆°n h√†ng
      function cancelOrder(orderId) {
        if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n h√†ng n√†y?")) {
          const orders = JSON.parse(localStorage.getItem("orders")) || [];

          // T√¨m ƒë∆°n h√†ng c·∫ßn h·ªßy
          const orderIndex = orders.findIndex((order) => {
            const id = `ABC-${new Date(order.date)
              .getTime()
              .toString()
              .slice(-6)}`;
            return id === orderId;
          });

          if (orderIndex !== -1) {
            // C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng
            orders[orderIndex].status = "cancelled";
            localStorage.setItem("orders", JSON.stringify(orders));

            // Hi·ªÉn th·ªã th√¥ng b√°o
            alert("ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c h·ªßy th√†nh c√¥ng");

            // T·∫£i l·∫°i danh s√°ch ƒë∆°n h√†ng
            loadOrders();
          }
        }
      }

      // T·∫£i ƒë∆°n h√†ng khi trang ƒë∆∞·ª£c m·ªü
      document.addEventListener("DOMContentLoaded", loadOrders);
    </script>
  </body>
</html>
